{
    "sourceFile": "src/pages/lojista/vendas/RegistrarVenda.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1770064003810,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1770124267307,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,9 +57,9 @@\n   const API_BASE_URL = import.meta.env.VITE_API_BASE_URL;\r\n \r\n   // buscando os dados no bd\r\n   const { data: veiculo, } = useGetData(buscaPlaca ? `/veiculos/placa/${placa}` : null)\r\n-  const { loadingdata: dadosPostais } = useGetExtern(cep ? `https://brasilapi.com.br/api/cep/v1/${cep}` : null)\r\n+  const { loading data: dadosPostais } = useGetExtern(cep ? `https://brasilapi.com.br/api/cep/v1/${cep}` : null)\r\n \r\n   const { createData } = usePostData('/vendas');\r\n \r\n   // Só busca o vendendor se soubermos a loja:\r\n"
                },
                {
                    "date": 1770124364858,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,444 @@\n+import ContainerSecundario from '../../../components/container/ContainerSecundario'\r\n+import \"../../../assets/css/thead.css\";\r\n+import \"../../../assets/css/themify-icons.css\"\r\n+import Box from '../../../components/box/Box';\r\n+import Input from '../../../components/input/Input';\r\n+import Form from '../../../components/form/Form';\r\n+import { formatCPF, formatCEP, formatDate, formatTel, formatValue } from \"../../../hooks/useMask\"\r\n+import { useState, useEffect, useRef } from \"react\";\r\n+import { useGetData } from '../../../services/useGetData';\r\n+import { usePostData } from '../../../services/usePostData';\r\n+import { calcValorFinanceiro } from '../../../hooks/useCalc';\r\n+import { formatTimestamp } from '../../../hooks/formatDate';\r\n+import Button from '../../../components/button/Button';\r\n+import { useGetExtern } from '../../../services/useGetExtrern';\r\n+import { useLojista } from '../../../hooks/useLojista';\r\n+\r\n+\r\n+const RegistrarVenda = () => {\r\n+\r\n+  const [placa, setPlaca] = useState('')\r\n+  const [comprador, setComprador] = useState('')\r\n+  const [nascimento, setNascimento] = useState(\"\")\r\n+  const [cpf, setCpf] = useState(\"\")\r\n+  const [rg, setRg] = useState('')\r\n+  const [telefone, setTelefone] = useState(\"\")\r\n+  const [email, setEmail] = useState('')\r\n+  const [cep, setCep] = useState(\"\")\r\n+  const [endereco, setEndereco] = useState('')\r\n+  const [valorFipe, setValorFipe] = useState('')\r\n+  const [valorVenda, setValorVenda] = useState('')\r\n+  const [valorFinanciamento, setValorFinanciamento] = useState('')\r\n+  const [valorEntrada, setValorEntrada] = useState('')\r\n+  const [instituicao, setInstituicao] = useState('')\r\n+  const [condicoes, setCondicoes] = useState(false)\r\n+  const [tipoVenda, setTipoVenda] = useState('')\r\n+  const [observacoes, setObservacoes] = useState('')\r\n+  const [buscaPlaca, setBuscaPlaca] = useState(\"\")\r\n+  const [dadosVeiculo, setDadosVeiculo] = useState({ placa: '', marca: '', modelo: '', cor: '', renavam: '', unidade: '' })\r\n+  const [dadosCEP, setDadosCEP] = useState({ cep: '', rua: '', cidade: '', bairro: '', uf: '' })\r\n+  const [vendedor, setVendedor] = useState({ nome: '', unidade: '' })\r\n+\r\n+\r\n+  //Limpa o formulario apos o envio\r\n+  const resetForm = () => {\r\n+    setPlaca(''); setComprador(''); setNascimento(''); setCpf(''); setRg(''); setTelefone(''); setEmail(''); setCep(''); setEndereco(''); setValorFipe('');\r\n+    setValorVenda(''); setValorEntrada(''); setInstituicao(''); setCondicoes(false); setTipoVenda(''); setObservacoes(''); setBuscaPlaca('');\r\n+    setDadosVeiculo({ placa: '', marca: '', modelo: '', cor: '', renavam: '', unidade: '' });\r\n+    setDadosCEP({ cep: '', rua: '', cidade: '', bairro: '', uf: '' });\r\n+    setVendedor({ nome: '', unidade: '' });\r\n+    ultimaPlacaBuscada.current = ''; // também reseta a ref\r\n+  };\r\n+\r\n+  //Verifica a loja ativa no momento\r\n+  const { lojaAtiva } = useLojista();\r\n+\r\n+  // Base URL da API\r\n+  const API_BASE_URL = import.meta.env.VITE_API_BASE_URL;\r\n+\r\n+  // buscando os dados no bd\r\n+  const { data: veiculo, } = useGetData(buscaPlaca ? `/veiculos/placa/${placa}` : null)\r\n+  const { loading, data: dadosPostais } = useGetExtern(cep ? `https://brasilapi.com.br/api/cep/v1/${cep}` : null)\r\n+\r\n+  const { createData } = usePostData('/vendas');\r\n+\r\n+  // Só busca o vendendor se soubermos a loja:\r\n+  const { data: dadosVendedor } = useGetData(\r\n+    lojaAtiva?.nome ? `/vendedor/unidade/${encodeURIComponent(lojaAtiva.nome)}` : null\r\n+  );\r\n+\r\n+  // Ref para manter a referência atualizada da última placa buscada\r\n+  const ultimaPlacaBuscada = useRef('');\r\n+\r\n+  // Função chamada quando o input da placa perde o foco\r\n+  const handleBlur = async () => {\r\n+    const placaM = placa.trim().toUpperCase();\r\n+\r\n+    if (placaM.length !== 7) return;\r\n+    if (placaM === ultimaPlacaBuscada.current) return;\r\n+\r\n+    ultimaPlacaBuscada.current = placaM;\r\n+\r\n+    // Verificaçao e busca de dados de veiculo\r\n+    try {\r\n+      // 1 Verifica se a placa existe em vendas\r\n+      const resVenda = await fetch(`${API_BASE_URL}/vendas/placa/${placaM}`);\r\n+\r\n+      if (resVenda.status === 200) {\r\n+        // Já vendida → limpar e bloquear\r\n+        window.alert('Ja consta uma venda registrada para esta placa. Para confirmar os dados, acesse Consultar Venda.');\r\n+        setDadosVeiculo({ placa: '', marca: '', modelo: '', cor: '', renavam: '', unidade: '' });\r\n+        setBuscaPlaca(placaM);\r\n+        // Opcional: exibir mensagem ao usuário\r\n+        return;\r\n+      } else if (resVenda.status !== 404) {\r\n+        throw new Error(`Erro na API de vendas: ${resVenda.status}`);\r\n+      }\r\n+\r\n+      // 2. Busca veículo SOMENTE se não estiver vendida\r\n+      const resVeiculo = await fetch(`${API_BASE_URL}/veiculos/placa/${placaM}`);\r\n+\r\n+      if (resVeiculo.status === 200) {\r\n+        const dados = await resVeiculo.json();\r\n+\r\n+        setDadosVeiculo({\r\n+          placa: dados.placa || placaM,\r\n+          marca: dados.marca || '',\r\n+          modelo: dados.modelo || '',\r\n+          cor: dados.cor || '',\r\n+          renavam: dados.renavam || dados.renavan || '', // cobre ambos os nomes\r\n+          unidade: dados.unidade || ''\r\n+        });\r\n+      } else {\r\n+        // Veículo não encontrado\r\n+        setDadosVeiculo({ placa: '', marca: '', modelo: '', cor: '', renavam: '', unidade: '' });\r\n+      }\r\n+\r\n+      setBuscaPlaca(placaM);\r\n+\r\n+    } catch (erro) {\r\n+      console.error('Erro ao buscar placa:', erro);\r\n+      setDadosVeiculo({ placa: '', marca: '', modelo: '', cor: '', renavam: '', unidade: '' });\r\n+      setBuscaPlaca(placaM);\r\n+    }\r\n+  };\r\n+\r\n+\r\n+  //Calcula o valor financiado\r\n+  useEffect(() => {\r\n+    const resultado = calcValorFinanceiro(valorVenda, valorEntrada);\r\n+    setValorFinanciamento(resultado);\r\n+  }, [valorVenda, valorEntrada])\r\n+\r\n+\r\n+\r\n+  //Valida se a venda e à vista. Caso nao seja, os inputs de entrada e valor financiado sao liberados\r\n+  const handleVendaChange = (e) => {\r\n+    setTipoVenda(e.target.value)\r\n+    if (e.target.value === 'aVista') {\r\n+      setCondicoes(false)\r\n+      setInstituicao(\"A Vista\")\r\n+    } else {\r\n+      setCondicoes(true)\r\n+    }\r\n+  }\r\n+\r\n+  // Preencher campos quando os dados solicitados chegarem\r\n+  useEffect(() => {\r\n+    if (veiculo && !veiculo.erro) {\r\n+      //console.log('Dados do veículo recebidos:', veiculo); // Debug\r\n+      setDadosVeiculo(prev => ({\r\n+        ...prev,\r\n+        marca: veiculo.marca || '',\r\n+        modelo: veiculo.modelo || '',\r\n+        cor: veiculo.cor || '',\r\n+        renavam: veiculo.renavan || '',\r\n+        unidade: veiculo.unidade || ''\r\n+      }));\r\n+    } else if (veiculo && veiculo.erro) {\r\n+      console.log('Veículo não encontrado');;\r\n+    }\r\n+\r\n+    //Obtendo os dados postais\r\n+    if (dadosPostais && !dadosPostais.erro) {\r\n+      //console.log('Dados postais recebidos: ', dadosPostais);\r\n+      const ruaTruncada = dadosPostais.street ? dadosPostais.street.substring(0, 30) : '';\r\n+      \r\n+      setDadosCEP(prev => ({\r\n+        ...prev,\r\n+        cep: dadosPostais.cep,\r\n+        rua: ruaTruncada,\r\n+        cidade: dadosPostais.city,\r\n+        uf: dadosPostais.state,\r\n+        bairro: dadosPostais.neighborhood,\r\n+      }))\r\n+    } else if (dadosPostais && dadosPostais.erro) {\r\n+      //console.log(\"Endereço nao encontrado ou CEP inválido\")\r\n+    }\r\n+\r\n+    //Obtendo os dados do vendedor\r\n+    if (dadosVendedor && !dadosVendedor.erro) {\r\n+      console.log('Dados do vendedor recebidos: ', dadosVendedor)\r\n+      setVendedor(prev => ({\r\n+        ...prev,\r\n+        id: dadosVendedor.id,\r\n+        nome: dadosVendedor.nome,\r\n+        unidade: dadosVendedor.unidade\r\n+      }))\r\n+    }\r\n+\r\n+\r\n+\r\n+  }, [veiculo, dadosPostais, dadosVendedor]);\r\n+\r\n+  // Função para converter campos em CAIXA ALTA\r\n+  const toUpperFields = (obj, fields = []) => {\r\n+    const copy = { ...obj }\r\n+    fields.forEach((f) => {\r\n+      if (copy[f] !== undefined && copy[f] !== null) {\r\n+        copy[f] = String(copy[f]).toUpperCase()\r\n+      }\r\n+    })\r\n+    return copy\r\n+  }\r\n+\r\n+  //Dados que serao obtidos da tabela veiculo (retornando como veiculo.dado), e serao enviados à tabela vendas\r\n+  const handleSubmit = async (e) => {\r\n+    e.preventDefault()\r\n+\r\n+    const dataRegistro = formatTimestamp(new Date())\r\n+\r\n+    //Verificando se a loja está ativa\r\n+    if (!lojaAtiva || !lojaAtiva.nome) {\r\n+      alert(\"Nenhuma loja associada à sua conta. Contate o administrador.\");\r\n+      return;\r\n+    }\r\n+\r\n+    //Verificando se a loja em que o veículo está cadastrado é a mesma em que o usuario está logado\r\n+    if (veiculo?.unidade !== lojaAtiva.nome) {\r\n+      alert(`O veículo pertence à loja \"${veiculo.unidade}\", mas você está na loja \"${lojaAtiva.nome}\". Operação não permitida.`);\r\n+      return;\r\n+    }\r\n+\r\n+    let dados = {\r\n+      placa, id: veiculo.id, marca: veiculo.marca, modelo: veiculo.modelo, cor: veiculo.cor, unidade: lojaAtiva.nome,\r\n+      renavam: veiculo.renavan, comprador, vendedor, nascimento, rg, cpf, telefone, email, cep: dadosPostais.cep, rua: dadosCEP.rua,\r\n+      endereco, bairro: dadosPostais.neighborhood, cidade: dadosPostais.city, uf: dadosPostais.state,\r\n+      valorVenda, valorFipe, valorFinanciamento, valorEntrada, tipoVenda, instituicao, dataRegistro, observacoes\r\n+    }\r\n+\r\n+    // Padroniza para caixa alta\r\n+    dados = toUpperFields(dados, ['placa', 'marca', 'modelo', 'cor', 'unidade', 'comprador', 'vendedor', 'endereco', 'bairro', 'rua', 'cidade', 'uf',\r\n+      'instituicao', 'tipoVenda', 'observacoes'\r\n+    ])\r\n+\r\n+    const confirmou = window.confirm(\"Confirma o registro da venda?\")\r\n+    if (!confirmou) {\r\n+      window.alert('Registro de venda cancelado')\r\n+      return\r\n+    }\r\n+\r\n+    console.log('Dados a serem enviados: ', dados)\r\n+\r\n+    // Validação simples dos campos obrigatórios\r\n+    if (!window.confirm.ok && comprador === \"\" || cpf === \"\" || rg === \"\" || telefone === \"\" || email === \"\" || cep === \"\" || endereco === \"\" || valorFipe === \"\" ||\r\n+      valorVenda === \"\" || tipoVenda === \"\") {\r\n+      window.alert(\"Por favor, verifique o formulario novamente e preencha todos os campos\")\r\n+    } else {\r\n+      try {\r\n+        const resultado = await createData(dados)\r\n+        console.log('Venda cadastrada com sucesso, ', resultado)\r\n+        window.alert('Venda registrada com sucesso')\r\n+\r\n+        resetForm() //Chama a função que limpa o formulario\r\n+        window.scrollTo({ top: 0, behavior: 'smooth' });//Retorna a pagina para o topo\r\n+      } catch (err) {\r\n+        console.error('Falha ao registrar a venda: ', err)\r\n+      }\r\n+    }\r\n+  }\r\n+\r\n+  // Função para lidar com a mudança de unidade\r\n+  const handleVendedorChange = (e) => {\r\n+    const selectedOption = e.target.selectedOptions[0]\r\n+    const id = Number(selectedOption.value)\r\n+    const nome = selectedOption.getAttribute('data-descricao')\r\n+    setVendedor(nome)\r\n+  }\r\n+\r\n+  return (\r\n+    <ContainerSecundario>\r\n+\r\n+      <div className='container d-flex flex-column ' id=\"path\" >\r\n+        <div className=\"d-flex align-items-start \">\r\n+          <div className=\"p-2\">\r\n+            <a className=\"link_a\" href=\"/\">Gestão</a>\r\n+          </div>\r\n+          <div className=\"p-2\">\r\n+            <i className=' ti ti-angle-right ' id='card-path' />\r\n+          </div>\r\n+          <div className=\"p-2\">\r\n+            <a className=\"link_a\" href=\"/lojista/\">Lojista</a>\r\n+          </div>\r\n+          <div className=\"p-2\">\r\n+            <i className=' ti ti-angle-right ' id='card-path' />\r\n+          </div>\r\n+          <div className=\"p-2\">\r\n+            <p className='atual'>Registrar Venda </p>\r\n+          </div>\r\n+        </div>\r\n+      </div>\r\n+      <div className=\"container d-flex justify-content-center card-container\">\r\n+        <Box onSubmit={handleSubmit}>\r\n+          <div className='panel-heading'>\r\n+            <i className='ti ti-car' id=\"ti-black\" ></i>\r\n+            <p>REGISTRAR A VENDA DE UM VEÍCULO <br /> Informe os dados do veículo</p>\r\n+          </div>\r\n+          <Form >\r\n+\r\n+            <div className=\"col-12 col-md-2\">\r\n+              <Input label={\"Placa:\"} type={\"text\"} maxLength={\"7\"} style={{ width: '80px' }} nameInput={\"placa\"}\r\n+                value={placa} onChange={(e) => setPlaca(e.target.value)} onBlur={handleBlur} required />\r\n+            </div>\r\n+            <div className=\"col-12 col-md-3\">\r\n+              <Input label={\"Marca:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"marca\"} value={dadosVeiculo.marca} readOnly />\r\n+            </div>\r\n+            <div className=\"col-12 col-md-3\">\r\n+              <Input label={\"Modelo:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"modelo\"} value={dadosVeiculo.modelo} readOnly />\r\n+            </div>\r\n+            <div className=\"col-12 col-md-4\">\r\n+              <Input label={\"Cor:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"cor\"} value={dadosVeiculo.cor} readOnly />\r\n+            </div>\r\n+            <div className=\"col-12 col-md-3\">\r\n+              <Input label={\"Renavam:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"renavam\"} value={dadosVeiculo.renavam} readOnly />\r\n+            </div>\r\n+            <div className=\"col-12 col-md-6\">\r\n+              <Input label={\"Loja:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"unidade\"} value={dadosVeiculo.unidade} readOnly />\r\n+            </div>\r\n+          </Form>\r\n+          <div className='sub-panel-heading'>\r\n+            <i className='ti ti-user' id=\"ti-black\"></i>\r\n+            <p>DADOS DO COMPRADOR <br /> Informe os dados do comprador</p>\r\n+          </div>\r\n+          <Form>\r\n+            <div className=\"col-6 col-md-5\">\r\n+              <Input label={\"Nome Completo:\"} type={\"text\"} style={{ width: '250px' }} nameInput={\"comprador\"} value={comprador}\r\n+                onChange={(e) => setComprador(e.target.value)} required />\r\n+            </div>\r\n+            <div className=\"col-6 col-md-4\">\r\n+              <Input label={\"Data de Nascimento:\"} style={{ width: '110px' }} value={nascimento}\r\n+                nameInput={\"data\"} onChange={(e) => setNascimento(formatDate(e.target.value))} placeholder={\"dd/mm/aaaa\"} required />\r\n+            </div>\r\n+            <div className=\"col-6 col-md-3\">\r\n+              <Input label={\"CPF:\"} type={\"text\"} style={{ width: '150px' }} maxLength={14}\r\n+                nameInput={\"modelo\"} value={cpf} onChange={(e) => setCpf(formatCPF(e.target.value))} placeholder={\"XXX.XXX.XXX-XX\"} required />\r\n+            </div>\r\n+            <div className=\"col-6 col-md-3\">\r\n+              <Input label={\"RG:\"} type={\"text\"} style={{ width: '150px' }} maxLength={14}\r\n+                nameInput={\"rg\"} value={rg} onChange={(e) => setRg(e.target.value)} required />\r\n+            </div>\r\n+            <div className=\"col-6 col-md-3\">\r\n+              <Input label={\"Telefone:\"} type={\"text\"} style={{ width: '150px' }} maxLength={14}\r\n+                nameInput={\"telefone\"} value={telefone} onChange={(e) => setTelefone(formatTel(e.target.value))} placeholder={\"(XX)XXXXX-XXXX\"} required />\r\n+            </div>\r\n+            <div className=\"col-6 col-md-3\">\r\n+              <Input label={\"Email:\"} type={\"text\"} style={{ width: '200px' }} nameInput={\"email\"} value={email} onChange={(e) => setEmail(e.target.value)} required />\r\n+            </div>\r\n+            <div className=\"col-6 col-md-4\">\r\n+              <Input label={\"CEP:\"} type={\"text\"} style={{ width: '100px' }} maxLength={9}\r\n+                nameInput={\"cep\"} value={cep} onChange={(e) => setCep(formatCEP(e.target.value))} onBlur={handleBlur} required />\r\n+            </div>\r\n+            <div className=\"col-6 col-md-4\">\r\n+              <Input label={\"Logradouro:\"} type={\"text\"} style={{ width: '250px' }}\r\n+                nameInput={\"logradouro\"} value={dadosCEP.rua} readOnly />\r\n+            </div>\r\n+            <div className=\"col-6 col-md-4\">\r\n+              <Input label={\"Complemento:\"} type={\"text\"} style={{ width: '200px' }} nameInput={\"complemento\"} value={endereco}\r\n+                onChange={(e) => setEndereco(e.target.value)} required />\r\n+            </div>\r\n+            <div className=\"col-6 col-md-4\">\r\n+              <Input label={\"Bairro:\"} type={\"text\"} style={{ width: '200px' }} nameInput={\"bairro\"} value={dadosPostais.neighborhood} readOnly />\r\n+            </div>\r\n+            <div className=\"col-12 col-md-4\">\r\n+              <Input label={\"Cidade:\"} type={\"text\"} style={{ width: '200px' }} nameInput={\"cidade\"} value={dadosPostais.city} readOnly />\r\n+            </div>\r\n+            <div className=\"col-12 col-md-3\">\r\n+              <Input label={\"UF:\"} type={\"text\"} style={{ width: '70px' }} nameInput={\"uf\"} value={dadosPostais.state} readOnly />\r\n+            </div>\r\n+          </Form>\r\n+          <div className='sub-panel-heading'>\r\n+            <i className='ti ti-money' id=\"ti-black\"></i>\r\n+            <p>DADOS DA TRANSAÇÃO <br /> Informe os dados da venda</p>\r\n+          </div>\r\n+          <Form>{/*Select de vendedores */}\r\n+            <div className='col-12 col-md-4' id='select-all'>\r\n+              <label className=\"label\" id=\"select-label\"><span>Vendedor:</span></label>\r\n+              <select type='text' name='loja' value={vendedor} onChange={handleVendedorChange} className=\"select-item\" required >\r\n+                <option value=\"\" >SELECIONE UM VENDEDOR</option>\r\n+                {dadosVendedor.map((vendedores) => (\r\n+                  <option key={vendedores.nome} value={vendedores.nome} data-descricao={vendedores.nome}>\r\n+                    {vendedores.nome}\r\n+                  </option>\r\n+                ))}\r\n+              </select>\r\n+            </div>\r\n+            <br />\r\n+            <div className='negociacao'>\r\n+              <p>Forma de Negociação: </p>\r\n+              <div className=\"form-check \" id=\"options\">\r\n+                <Input label={\"Financeira\"} name={\"tipoNegociacao\"} className=\"form-check-input\" type={\"radio\"} checked={tipoVenda === 'financeira'}\r\n+                  value={\"financeira\"} onChange={handleVendaChange} onClick={(e) => setTipoVenda(e.target.value)} />\r\n+                {tipoVenda === 'financeira' && (\r\n+                  <Input placeholder=\"Informe a financeira\" nameInput={\"financeira\"} value={instituicao} onChange={(e) => setInstituicao(e.target.value)} required />\r\n+                )}\r\n+                <Input label={\"Banco\"} name={\"tipoNegociacao\"} className=\"form-check-input\" type={\"radio\"} checked={tipoVenda === 'banco'}\r\n+                  value={\"banco\"} onChange={handleVendaChange} onClick={(e) => setTipoVenda(e.target.value)} />\r\n+                {tipoVenda === 'banco' && (\r\n+                  <Input placeholder=\"Informe o banco\" nameInput={\"banco\"} value={instituicao} onChange={(e) => setInstituicao(e.target.value)} required />\r\n+                )}\r\n+                <Input label={\"Consorcio\"} name={\"tipoNegociacao\"} className=\"form-check-input\" type={\"radio\"} checked={tipoVenda === 'consorcio'}\r\n+                  value={\"consorcio\"} onChange={handleVendaChange} onClick={(e) => setTipoVenda(e.target.value)} />\r\n+                {tipoVenda === 'consorcio' && (\r\n+                  <Input placeholder=\"Informe o consórcio\" nameInput={\"consorcio\"} value={instituicao} type={\"text\"} onChange={(e) => setInstituicao(e.target.value)} required />\r\n+                )}\r\n+                <Input label={\"À Vista\"} name={\"tipoNegociacao\"} className=\"form-check-input \" type={\"radio\"} checked={tipoVenda === 'aVista'}\r\n+                  value={\"aVista\"} onChange={handleVendaChange} onClick={(e) => setTipoVenda(e.target.value)} />\r\n+              </div>\r\n+            </div>\r\n+            <div className=\"col-12 col-md-6\">\r\n+              <Input label={\"Valor Fipe R$:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"valor_fipe\"} value={valorFipe}\r\n+                onChange={(e) => setValorFipe(formatValue(e.target.value))} required />\r\n+            </div>\r\n+            <div className=\"col-12 col-md-6\">\r\n+              <Input label={\"Valor Venda R$:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"valor_venda\"} value={valorVenda}\r\n+                onChange={(e) => setValorVenda(formatValue(e.target.value))} required />\r\n+            </div>\r\n+            {condicoes && (\r\n+              <>\r\n+                <div className=\"col-12 col-md-6\">\r\n+                  <Input label={\"Valor Entrada R$:\"} type={\"text\"} style={{ width: '150px' }} name={\"valor_entrada\"} value={valorEntrada}\r\n+                    onChange={(e) => setValorEntrada(formatValue(e.target.value))} onBlur={handleBlur} required />\r\n+                </div>\r\n+                <div className=\"col-12 col-md-6\">\r\n+                  <Input label={\"Valor Financiado R$:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"valor_financiado\"}\r\n+                    value={valorFinanciamento} onChange={(e) => setValorFinanciamento(e.target.value)} readOnly />\r\n+                </div>\r\n+              </>\r\n+            )}\r\n+            <div className=\"col-6 col-md-12\">\r\n+              <Input label={\"Observações:\"} type={\"text\"} style={{ width: '500px' }} nameInput={\"observacoes\"}\r\n+                value={observacoes} onChange={(e) => setObservacoes(e.target.value)} required />\r\n+            </div>\r\n+            <div className=\"col-6 col-md-12\">\r\n+              <Button onClick={handleSubmit} variant='primary' >ENVIAR</Button>\r\n+            </div>\r\n+          </Form>\r\n+        </Box>\r\n+\r\n+      </div>\r\n+\r\n+    </ContainerSecundario>\r\n+  )\r\n+}\r\n+\r\n+export default RegistrarVenda\r\n"
                }
            ],
            "date": 1770064003810,
            "name": "Commit-0",
            "content": "import ContainerSecundario from '../../../components/container/ContainerSecundario'\r\nimport \"../../../assets/css/thead.css\";\r\nimport \"../../../assets/css/themify-icons.css\"\r\nimport Box from '../../../components/box/Box';\r\nimport Input from '../../../components/input/Input';\r\nimport Form from '../../../components/form/Form';\r\nimport { formatCPF, formatCEP, formatDate, formatTel, formatValue } from \"../../../hooks/useMask\"\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { useGetData } from '../../../services/useGetData';\r\nimport { usePostData } from '../../../services/usePostData';\r\nimport { calcValorFinanceiro } from '../../../hooks/useCalc';\r\nimport { formatTimestamp } from '../../../hooks/formatDate';\r\nimport Button from '../../../components/button/Button';\r\nimport { useGetExtern } from '../../../services/useGetExtrern';\r\nimport { useLojista } from '../../../hooks/useLojista';\r\n\r\n\r\nconst RegistrarVenda = () => {\r\n\r\n  const [placa, setPlaca] = useState('')\r\n  const [comprador, setComprador] = useState('')\r\n  const [nascimento, setNascimento] = useState(\"\")\r\n  const [cpf, setCpf] = useState(\"\")\r\n  const [rg, setRg] = useState('')\r\n  const [telefone, setTelefone] = useState(\"\")\r\n  const [email, setEmail] = useState('')\r\n  const [cep, setCep] = useState(\"\")\r\n  const [endereco, setEndereco] = useState('')\r\n  const [valorFipe, setValorFipe] = useState('')\r\n  const [valorVenda, setValorVenda] = useState('')\r\n  const [valorFinanciamento, setValorFinanciamento] = useState('')\r\n  const [valorEntrada, setValorEntrada] = useState('')\r\n  const [instituicao, setInstituicao] = useState('')\r\n  const [condicoes, setCondicoes] = useState(false)\r\n  const [tipoVenda, setTipoVenda] = useState('')\r\n  const [observacoes, setObservacoes] = useState('')\r\n  const [buscaPlaca, setBuscaPlaca] = useState(\"\")\r\n  const [dadosVeiculo, setDadosVeiculo] = useState({ placa: '', marca: '', modelo: '', cor: '', renavam: '', unidade: '' })\r\n  const [dadosCEP, setDadosCEP] = useState({ cep: '', rua: '', cidade: '', bairro: '', uf: '' })\r\n  const [vendedor, setVendedor] = useState({ nome: '', unidade: '' })\r\n\r\n\r\n  //Limpa o formulario apos o envio\r\n  const resetForm = () => {\r\n    setPlaca(''); setComprador(''); setNascimento(''); setCpf(''); setRg(''); setTelefone(''); setEmail(''); setCep(''); setEndereco(''); setValorFipe('');\r\n    setValorVenda(''); setValorEntrada(''); setInstituicao(''); setCondicoes(false); setTipoVenda(''); setObservacoes(''); setBuscaPlaca('');\r\n    setDadosVeiculo({ placa: '', marca: '', modelo: '', cor: '', renavam: '', unidade: '' });\r\n    setDadosCEP({ cep: '', rua: '', cidade: '', bairro: '', uf: '' });\r\n    setVendedor({ nome: '', unidade: '' });\r\n    ultimaPlacaBuscada.current = ''; // também reseta a ref\r\n  };\r\n\r\n  //Verifica a loja ativa no momento\r\n  const { lojaAtiva } = useLojista();\r\n\r\n  // Base URL da API\r\n  const API_BASE_URL = import.meta.env.VITE_API_BASE_URL;\r\n\r\n  // buscando os dados no bd\r\n  const { data: veiculo, } = useGetData(buscaPlaca ? `/veiculos/placa/${placa}` : null)\r\n  const { data: dadosPostais } = useGetExtern(cep ? `https://brasilapi.com.br/api/cep/v1/${cep}` : null)\r\n\r\n  const { createData } = usePostData('/vendas');\r\n\r\n  // Só busca o vendendor se soubermos a loja:\r\n  const { data: dadosVendedor } = useGetData(\r\n    lojaAtiva?.nome ? `/vendedor/unidade/${encodeURIComponent(lojaAtiva.nome)}` : null\r\n  );\r\n\r\n  // Ref para manter a referência atualizada da última placa buscada\r\n  const ultimaPlacaBuscada = useRef('');\r\n\r\n  // Função chamada quando o input da placa perde o foco\r\n  const handleBlur = async () => {\r\n    const placaM = placa.trim().toUpperCase();\r\n\r\n    if (placaM.length !== 7) return;\r\n    if (placaM === ultimaPlacaBuscada.current) return;\r\n\r\n    ultimaPlacaBuscada.current = placaM;\r\n\r\n    // Verificaçao e busca de dados de veiculo\r\n    try {\r\n      // 1 Verifica se a placa existe em vendas\r\n      const resVenda = await fetch(`${API_BASE_URL}/vendas/placa/${placaM}`);\r\n\r\n      if (resVenda.status === 200) {\r\n        // Já vendida → limpar e bloquear\r\n        window.alert('Ja consta uma venda registrada para esta placa. Para confirmar os dados, acesse Consultar Venda.');\r\n        setDadosVeiculo({ placa: '', marca: '', modelo: '', cor: '', renavam: '', unidade: '' });\r\n        setBuscaPlaca(placaM);\r\n        // Opcional: exibir mensagem ao usuário\r\n        return;\r\n      } else if (resVenda.status !== 404) {\r\n        throw new Error(`Erro na API de vendas: ${resVenda.status}`);\r\n      }\r\n\r\n      // 2. Busca veículo SOMENTE se não estiver vendida\r\n      const resVeiculo = await fetch(`${API_BASE_URL}/veiculos/placa/${placaM}`);\r\n\r\n      if (resVeiculo.status === 200) {\r\n        const dados = await resVeiculo.json();\r\n\r\n        setDadosVeiculo({\r\n          placa: dados.placa || placaM,\r\n          marca: dados.marca || '',\r\n          modelo: dados.modelo || '',\r\n          cor: dados.cor || '',\r\n          renavam: dados.renavam || dados.renavan || '', // cobre ambos os nomes\r\n          unidade: dados.unidade || ''\r\n        });\r\n      } else {\r\n        // Veículo não encontrado\r\n        setDadosVeiculo({ placa: '', marca: '', modelo: '', cor: '', renavam: '', unidade: '' });\r\n      }\r\n\r\n      setBuscaPlaca(placaM);\r\n\r\n    } catch (erro) {\r\n      console.error('Erro ao buscar placa:', erro);\r\n      setDadosVeiculo({ placa: '', marca: '', modelo: '', cor: '', renavam: '', unidade: '' });\r\n      setBuscaPlaca(placaM);\r\n    }\r\n  };\r\n\r\n\r\n  //Calcula o valor financiado\r\n  useEffect(() => {\r\n    const resultado = calcValorFinanceiro(valorVenda, valorEntrada);\r\n    setValorFinanciamento(resultado);\r\n  }, [valorVenda, valorEntrada])\r\n\r\n\r\n\r\n  //Valida se a venda e à vista. Caso nao seja, os inputs de entrada e valor financiado sao liberados\r\n  const handleVendaChange = (e) => {\r\n    setTipoVenda(e.target.value)\r\n    if (e.target.value === 'aVista') {\r\n      setCondicoes(false)\r\n      setInstituicao(\"A Vista\")\r\n    } else {\r\n      setCondicoes(true)\r\n    }\r\n  }\r\n\r\n  // Preencher campos quando os dados solicitados chegarem\r\n  useEffect(() => {\r\n    if (veiculo && !veiculo.erro) {\r\n      //console.log('Dados do veículo recebidos:', veiculo); // Debug\r\n      setDadosVeiculo(prev => ({\r\n        ...prev,\r\n        marca: veiculo.marca || '',\r\n        modelo: veiculo.modelo || '',\r\n        cor: veiculo.cor || '',\r\n        renavam: veiculo.renavan || '',\r\n        unidade: veiculo.unidade || ''\r\n      }));\r\n    } else if (veiculo && veiculo.erro) {\r\n      console.log('Veículo não encontrado');;\r\n    }\r\n\r\n    //Obtendo os dados postais\r\n    if (dadosPostais && !dadosPostais.erro) {\r\n      //console.log('Dados postais recebidos: ', dadosPostais);\r\n      const ruaTruncada = dadosPostais.street ? dadosPostais.street.substring(0, 30) : '';\r\n      setDadosCEP(prev => ({\r\n        ...prev,\r\n        cep: dadosPostais.cep,\r\n        rua: ruaTruncada,\r\n        cidade: dadosPostais.city,\r\n        uf: dadosPostais.state,\r\n        bairro: dadosPostais.neighborhood,\r\n      }))\r\n    } else if (dadosPostais && dadosPostais.erro) {\r\n      //console.log(\"Endereço nao encontrado ou CEP inválido\")\r\n    }\r\n\r\n    //Obtendo os dados do vendedor\r\n    if (dadosVendedor && !dadosVendedor.erro) {\r\n      console.log('Dados do vendedor recebidos: ', dadosVendedor)\r\n      setVendedor(prev => ({\r\n        ...prev,\r\n        id: dadosVendedor.id,\r\n        nome: dadosVendedor.nome,\r\n        unidade: dadosVendedor.unidade\r\n      }))\r\n    }\r\n\r\n\r\n\r\n  }, [veiculo, dadosPostais, dadosVendedor]);\r\n\r\n  // Função para converter campos em CAIXA ALTA\r\n  const toUpperFields = (obj, fields = []) => {\r\n    const copy = { ...obj }\r\n    fields.forEach((f) => {\r\n      if (copy[f] !== undefined && copy[f] !== null) {\r\n        copy[f] = String(copy[f]).toUpperCase()\r\n      }\r\n    })\r\n    return copy\r\n  }\r\n\r\n  //Dados que serao obtidos da tabela veiculo (retornando como veiculo.dado), e serao enviados à tabela vendas\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault()\r\n\r\n    const dataRegistro = formatTimestamp(new Date())\r\n\r\n    //Verificando se a loja está ativa\r\n    if (!lojaAtiva || !lojaAtiva.nome) {\r\n      alert(\"Nenhuma loja associada à sua conta. Contate o administrador.\");\r\n      return;\r\n    }\r\n\r\n    //Verificando se a loja em que o veículo está cadastrado é a mesma em que o usuario está logado\r\n    if (veiculo?.unidade !== lojaAtiva.nome) {\r\n      alert(`O veículo pertence à loja \"${veiculo.unidade}\", mas você está na loja \"${lojaAtiva.nome}\". Operação não permitida.`);\r\n      return;\r\n    }\r\n\r\n    let dados = {\r\n      placa, id: veiculo.id, marca: veiculo.marca, modelo: veiculo.modelo, cor: veiculo.cor, unidade: lojaAtiva.nome,\r\n      renavam: veiculo.renavan, comprador, vendedor, nascimento, rg, cpf, telefone, email, cep: dadosPostais.cep, rua: dadosCEP.rua,\r\n      endereco, bairro: dadosPostais.neighborhood, cidade: dadosPostais.city, uf: dadosPostais.state,\r\n      valorVenda, valorFipe, valorFinanciamento, valorEntrada, tipoVenda, instituicao, dataRegistro, observacoes\r\n    }\r\n\r\n    // Padroniza para caixa alta\r\n    dados = toUpperFields(dados, ['placa', 'marca', 'modelo', 'cor', 'unidade', 'comprador', 'vendedor', 'endereco', 'bairro', 'rua', 'cidade', 'uf',\r\n      'instituicao', 'tipoVenda', 'observacoes'\r\n    ])\r\n\r\n    const confirmou = window.confirm(\"Confirma o registro da venda?\")\r\n    if (!confirmou) {\r\n      window.alert('Registro de venda cancelado')\r\n      return\r\n    }\r\n\r\n    console.log('Dados a serem enviados: ', dados)\r\n\r\n    // Validação simples dos campos obrigatórios\r\n    if (!window.confirm.ok && comprador === \"\" || cpf === \"\" || rg === \"\" || telefone === \"\" || email === \"\" || cep === \"\" || endereco === \"\" || valorFipe === \"\" ||\r\n      valorVenda === \"\" || tipoVenda === \"\") {\r\n      window.alert(\"Por favor, verifique o formulario novamente e preencha todos os campos\")\r\n    } else {\r\n      try {\r\n        const resultado = await createData(dados)\r\n        console.log('Venda cadastrada com sucesso, ', resultado)\r\n        window.alert('Venda registrada com sucesso')\r\n\r\n        resetForm() //Chama a função que limpa o formulario\r\n        window.scrollTo({ top: 0, behavior: 'smooth' });//Retorna a pagina para o topo\r\n      } catch (err) {\r\n        console.error('Falha ao registrar a venda: ', err)\r\n      }\r\n    }\r\n  }\r\n\r\n  // Função para lidar com a mudança de unidade\r\n  const handleVendedorChange = (e) => {\r\n    const selectedOption = e.target.selectedOptions[0]\r\n    const id = Number(selectedOption.value)\r\n    const nome = selectedOption.getAttribute('data-descricao')\r\n    setVendedor(nome)\r\n  }\r\n\r\n  return (\r\n    <ContainerSecundario>\r\n\r\n      <div className='container d-flex flex-column ' id=\"path\" >\r\n        <div className=\"d-flex align-items-start \">\r\n          <div className=\"p-2\">\r\n            <a className=\"link_a\" href=\"/\">Gestão</a>\r\n          </div>\r\n          <div className=\"p-2\">\r\n            <i className=' ti ti-angle-right ' id='card-path' />\r\n          </div>\r\n          <div className=\"p-2\">\r\n            <a className=\"link_a\" href=\"/lojista/\">Lojista</a>\r\n          </div>\r\n          <div className=\"p-2\">\r\n            <i className=' ti ti-angle-right ' id='card-path' />\r\n          </div>\r\n          <div className=\"p-2\">\r\n            <p className='atual'>Registrar Venda </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"container d-flex justify-content-center card-container\">\r\n        <Box onSubmit={handleSubmit}>\r\n          <div className='panel-heading'>\r\n            <i className='ti ti-car' id=\"ti-black\" ></i>\r\n            <p>REGISTRAR A VENDA DE UM VEÍCULO <br /> Informe os dados do veículo</p>\r\n          </div>\r\n          <Form >\r\n\r\n            <div className=\"col-12 col-md-2\">\r\n              <Input label={\"Placa:\"} type={\"text\"} maxLength={\"7\"} style={{ width: '80px' }} nameInput={\"placa\"}\r\n                value={placa} onChange={(e) => setPlaca(e.target.value)} onBlur={handleBlur} required />\r\n            </div>\r\n            <div className=\"col-12 col-md-3\">\r\n              <Input label={\"Marca:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"marca\"} value={dadosVeiculo.marca} readOnly />\r\n            </div>\r\n            <div className=\"col-12 col-md-3\">\r\n              <Input label={\"Modelo:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"modelo\"} value={dadosVeiculo.modelo} readOnly />\r\n            </div>\r\n            <div className=\"col-12 col-md-4\">\r\n              <Input label={\"Cor:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"cor\"} value={dadosVeiculo.cor} readOnly />\r\n            </div>\r\n            <div className=\"col-12 col-md-3\">\r\n              <Input label={\"Renavam:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"renavam\"} value={dadosVeiculo.renavam} readOnly />\r\n            </div>\r\n            <div className=\"col-12 col-md-6\">\r\n              <Input label={\"Loja:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"unidade\"} value={dadosVeiculo.unidade} readOnly />\r\n            </div>\r\n          </Form>\r\n          <div className='sub-panel-heading'>\r\n            <i className='ti ti-user' id=\"ti-black\"></i>\r\n            <p>DADOS DO COMPRADOR <br /> Informe os dados do comprador</p>\r\n          </div>\r\n          <Form>\r\n            <div className=\"col-6 col-md-5\">\r\n              <Input label={\"Nome Completo:\"} type={\"text\"} style={{ width: '250px' }} nameInput={\"comprador\"} value={comprador}\r\n                onChange={(e) => setComprador(e.target.value)} required />\r\n            </div>\r\n            <div className=\"col-6 col-md-4\">\r\n              <Input label={\"Data de Nascimento:\"} style={{ width: '110px' }} value={nascimento}\r\n                nameInput={\"data\"} onChange={(e) => setNascimento(formatDate(e.target.value))} placeholder={\"dd/mm/aaaa\"} required />\r\n            </div>\r\n            <div className=\"col-6 col-md-3\">\r\n              <Input label={\"CPF:\"} type={\"text\"} style={{ width: '150px' }} maxLength={14}\r\n                nameInput={\"modelo\"} value={cpf} onChange={(e) => setCpf(formatCPF(e.target.value))} placeholder={\"XXX.XXX.XXX-XX\"} required />\r\n            </div>\r\n            <div className=\"col-6 col-md-3\">\r\n              <Input label={\"RG:\"} type={\"text\"} style={{ width: '150px' }} maxLength={14}\r\n                nameInput={\"rg\"} value={rg} onChange={(e) => setRg(e.target.value)} required />\r\n            </div>\r\n            <div className=\"col-6 col-md-3\">\r\n              <Input label={\"Telefone:\"} type={\"text\"} style={{ width: '150px' }} maxLength={14}\r\n                nameInput={\"telefone\"} value={telefone} onChange={(e) => setTelefone(formatTel(e.target.value))} placeholder={\"(XX)XXXXX-XXXX\"} required />\r\n            </div>\r\n            <div className=\"col-6 col-md-3\">\r\n              <Input label={\"Email:\"} type={\"text\"} style={{ width: '200px' }} nameInput={\"email\"} value={email} onChange={(e) => setEmail(e.target.value)} required />\r\n            </div>\r\n            <div className=\"col-6 col-md-4\">\r\n              <Input label={\"CEP:\"} type={\"text\"} style={{ width: '100px' }} maxLength={9}\r\n                nameInput={\"cep\"} value={cep} onChange={(e) => setCep(formatCEP(e.target.value))} onBlur={handleBlur} required />\r\n            </div>\r\n            <div className=\"col-6 col-md-4\">\r\n              <Input label={\"Logradouro:\"} type={\"text\"} style={{ width: '250px' }}\r\n                nameInput={\"logradouro\"} value={dadosCEP.rua} readOnly />\r\n            </div>\r\n            <div className=\"col-6 col-md-4\">\r\n              <Input label={\"Complemento:\"} type={\"text\"} style={{ width: '200px' }} nameInput={\"complemento\"} value={endereco}\r\n                onChange={(e) => setEndereco(e.target.value)} required />\r\n            </div>\r\n            <div className=\"col-6 col-md-4\">\r\n              <Input label={\"Bairro:\"} type={\"text\"} style={{ width: '200px' }} nameInput={\"bairro\"} value={dadosPostais.neighborhood} readOnly />\r\n            </div>\r\n            <div className=\"col-12 col-md-4\">\r\n              <Input label={\"Cidade:\"} type={\"text\"} style={{ width: '200px' }} nameInput={\"cidade\"} value={dadosPostais.city} readOnly />\r\n            </div>\r\n            <div className=\"col-12 col-md-3\">\r\n              <Input label={\"UF:\"} type={\"text\"} style={{ width: '70px' }} nameInput={\"uf\"} value={dadosPostais.state} readOnly />\r\n            </div>\r\n          </Form>\r\n          <div className='sub-panel-heading'>\r\n            <i className='ti ti-money' id=\"ti-black\"></i>\r\n            <p>DADOS DA TRANSAÇÃO <br /> Informe os dados da venda</p>\r\n          </div>\r\n          <Form>{/*Select de vendedores */}\r\n            <div className='col-12 col-md-4' id='select-all'>\r\n              <label className=\"label\" id=\"select-label\"><span>Vendedor:</span></label>\r\n              <select type='text' name='loja' value={vendedor} onChange={handleVendedorChange} className=\"select-item\" required >\r\n                <option value=\"\" >SELECIONE UM VENDEDOR</option>\r\n                {dadosVendedor.map((vendedores) => (\r\n                  <option key={vendedores.nome} value={vendedores.nome} data-descricao={vendedores.nome}>\r\n                    {vendedores.nome}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n            <br />\r\n            <div className='negociacao'>\r\n              <p>Forma de Negociação: </p>\r\n              <div className=\"form-check \" id=\"options\">\r\n                <Input label={\"Financeira\"} name={\"tipoNegociacao\"} className=\"form-check-input\" type={\"radio\"} checked={tipoVenda === 'financeira'}\r\n                  value={\"financeira\"} onChange={handleVendaChange} onClick={(e) => setTipoVenda(e.target.value)} />\r\n                {tipoVenda === 'financeira' && (\r\n                  <Input placeholder=\"Informe a financeira\" nameInput={\"financeira\"} value={instituicao} onChange={(e) => setInstituicao(e.target.value)} required />\r\n                )}\r\n                <Input label={\"Banco\"} name={\"tipoNegociacao\"} className=\"form-check-input\" type={\"radio\"} checked={tipoVenda === 'banco'}\r\n                  value={\"banco\"} onChange={handleVendaChange} onClick={(e) => setTipoVenda(e.target.value)} />\r\n                {tipoVenda === 'banco' && (\r\n                  <Input placeholder=\"Informe o banco\" nameInput={\"banco\"} value={instituicao} onChange={(e) => setInstituicao(e.target.value)} required />\r\n                )}\r\n                <Input label={\"Consorcio\"} name={\"tipoNegociacao\"} className=\"form-check-input\" type={\"radio\"} checked={tipoVenda === 'consorcio'}\r\n                  value={\"consorcio\"} onChange={handleVendaChange} onClick={(e) => setTipoVenda(e.target.value)} />\r\n                {tipoVenda === 'consorcio' && (\r\n                  <Input placeholder=\"Informe o consórcio\" nameInput={\"consorcio\"} value={instituicao} type={\"text\"} onChange={(e) => setInstituicao(e.target.value)} required />\r\n                )}\r\n                <Input label={\"À Vista\"} name={\"tipoNegociacao\"} className=\"form-check-input \" type={\"radio\"} checked={tipoVenda === 'aVista'}\r\n                  value={\"aVista\"} onChange={handleVendaChange} onClick={(e) => setTipoVenda(e.target.value)} />\r\n              </div>\r\n            </div>\r\n            <div className=\"col-12 col-md-6\">\r\n              <Input label={\"Valor Fipe R$:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"valor_fipe\"} value={valorFipe}\r\n                onChange={(e) => setValorFipe(formatValue(e.target.value))} required />\r\n            </div>\r\n            <div className=\"col-12 col-md-6\">\r\n              <Input label={\"Valor Venda R$:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"valor_venda\"} value={valorVenda}\r\n                onChange={(e) => setValorVenda(formatValue(e.target.value))} required />\r\n            </div>\r\n            {condicoes && (\r\n              <>\r\n                <div className=\"col-12 col-md-6\">\r\n                  <Input label={\"Valor Entrada R$:\"} type={\"text\"} style={{ width: '150px' }} name={\"valor_entrada\"} value={valorEntrada}\r\n                    onChange={(e) => setValorEntrada(formatValue(e.target.value))} onBlur={handleBlur} required />\r\n                </div>\r\n                <div className=\"col-12 col-md-6\">\r\n                  <Input label={\"Valor Financiado R$:\"} type={\"text\"} style={{ width: '150px' }} nameInput={\"valor_financiado\"}\r\n                    value={valorFinanciamento} onChange={(e) => setValorFinanciamento(e.target.value)} readOnly />\r\n                </div>\r\n              </>\r\n            )}\r\n            <div className=\"col-6 col-md-12\">\r\n              <Input label={\"Observações:\"} type={\"text\"} style={{ width: '500px' }} nameInput={\"observacoes\"}\r\n                value={observacoes} onChange={(e) => setObservacoes(e.target.value)} required />\r\n            </div>\r\n            <div className=\"col-6 col-md-12\">\r\n              <Button onClick={handleSubmit} variant='primary' >ENVIAR</Button>\r\n            </div>\r\n          </Form>\r\n        </Box>\r\n\r\n      </div>\r\n\r\n    </ContainerSecundario>\r\n  )\r\n}\r\n\r\nexport default RegistrarVenda\r\n"
        }
    ]
}